[gd_scene load_steps=40 format=3 uid="uid://dkqdr74jfv06a"]

[ext_resource type="Script" path="res://Scenes/game.gd" id="1_8sinw"]
[ext_resource type="Script" path="res://Scenes/path.gd" id="1_tkyns"]
[ext_resource type="Texture2D" uid="uid://dfc7c5ubbfky7" path="res://Assets/Road.png" id="2_v5di0"]
[ext_resource type="Script" path="res://Scenes/player.gd" id="3_meqjs"]
[ext_resource type="Texture2D" uid="uid://kogk0y8jjfed" path="res://Assets/NakedRoad.png" id="3_tq03e"]
[ext_resource type="Texture2D" uid="uid://oxirvbqgov8h" path="res://Assets/Car.png" id="4_qi03k"]
[ext_resource type="Texture2D" uid="uid://0tti3101cqou" path="res://Assets/smoke.png" id="5_5jckg"]
[ext_resource type="Texture2D" uid="uid://ckwb3vb8xjop7" path="res://Assets/grass.png" id="5_id1i5"]
[ext_resource type="Texture2D" uid="uid://b6xs3imprgymu" path="res://Assets/coin.png" id="6_e4o34"]
[ext_resource type="Texture2D" uid="uid://gisawo7qd8ll" path="res://Assets/cloud.png" id="6_yhhpp"]
[ext_resource type="Texture2D" uid="uid://bu720sol8xvvh" path="res://Assets/cone.png" id="7_wpsmu"]
[ext_resource type="Script" path="res://Scenes/billboard.gd" id="10_jff2p"]
[ext_resource type="Texture2D" uid="uid://cfdhdn7ukaegd" path="res://Assets/bush.png" id="11_epgcn"]
[ext_resource type="Texture2D" uid="uid://lvt2bmf3a2v3" path="res://Assets/assets.png" id="14_bm6gg"]
[ext_resource type="AudioStream" uid="uid://bxp7qll88rjyv" path="res://Assets/SFX/coin.mp3" id="15_pf4d7"]
[ext_resource type="Script" path="res://Scenes/gameui.gd" id="16_bm7o5"]
[ext_resource type="Texture2D" uid="uid://dxyrs1tu1k2nm" path="res://Assets/wheel.png" id="17_371yy"]

[sub_resource type="Curve2D" id="Curve2D_idbbu"]
bake_interval = 50.0
_data = {
"points": PackedVector2Array(374.005, -7.77505, 0, 0, 239, 965, 20.3182, 258.861, -20.3182, -258.861, 263, -187)
}
point_count = 2

[sub_resource type="Animation" id="Animation_q2fa2"]
resource_name = "Loop"
loop_mode = 1
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:scale")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(0.5, 0.5), Vector2(-0.5, 0.5)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:offset")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(0, 0), Vector2(0, -24)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_o6m6g"]
_data = {
"Loop": SubResource("Animation_q2fa2")
}

[sub_resource type="CircleShape2D" id="CircleShape2D_ofjcw"]
radius = 16.0

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_uj88y"]
radius = 16.0
height = 176.0

[sub_resource type="Animation" id="Animation_b6twg"]
resource_name = "Loop"
loop_mode = 1
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:skew")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.0, 0.0872665]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_7kkvb"]
_data = {
"Loop": SubResource("Animation_b6twg")
}

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_tln7t"]
radius = 24.0
height = 96.0

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_iau05"]
radius = 32.0
height = 112.0

[sub_resource type="Animation" id="Animation_48g6m"]
resource_name = "Fade"
length = 0.4
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:scale")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.4),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(0.8, 1), Vector2(1, -2)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:modulate")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.4),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Color(1, 1, 1, 1), Color(1, 1, 1, 0)]
}
tracks/2/type = "method"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath(".")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0.4),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [],
"method": &"queue_free"
}]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath(".:offset")
tracks/3/interp = 2
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 0.4),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(0, -18), Vector2(0, -24)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_xqs7r"]
_data = {
"Fade": SubResource("Animation_48g6m")
}

[sub_resource type="Animation" id="Animation_uucxq"]
resource_name = "Pop"
length = 0.3
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:scale")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [Vector2(0.3, 0.3), Vector2(0.5, -0.5), Vector2(1, 1), Vector2(-1, 1)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:modulate")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [Color(1, 1, 1, 0), Color(5, 5, 5, 1), Color(5, 5, 5, 1), Color(1, 1, 1, 0)]
}
tracks/2/type = "method"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath(".")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0.3),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [],
"method": &"queue_free"
}]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_f40we"]
_data = {
"Pop": SubResource("Animation_uucxq")
}

[sub_resource type="Curve" id="Curve_jtax1"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.652672, 1), 0.0, 0.0, 0, 0, Vector2(1, 0.426415), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="Gradient" id="Gradient_ncpum"]
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0)

[sub_resource type="ViewportTexture" id="ViewportTexture_pgm0o"]
viewport_path = NodePath("SubViewport")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_i3iis"]
resource_local_to_scene = true
shading_mode = 0
albedo_texture = SubResource("ViewportTexture_pgm0o")
uv1_scale = Vector3(6, 6, 6)
uv1_offset = Vector3(15.5, 1.5, 0)
texture_filter = 0

[sub_resource type="SphereMesh" id="SphereMesh_ulcu4"]
resource_local_to_scene = true
radius = 5.0
height = 10.0

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_b10va"]
sky_top_color = Color(0.322917, 0.606061, 1, 1)
sky_horizon_color = Color(0.595052, 0.798406, 1, 1)
ground_bottom_color = Color(0.0572917, 0.587565, 1, 1)
ground_horizon_color = Color(0.595052, 0.798406, 1, 1)

[sub_resource type="Sky" id="Sky_5fqhf"]
sky_material = SubResource("ProceduralSkyMaterial_b10va")

[sub_resource type="Environment" id="Environment_0i5t4"]
background_mode = 2
sky = SubResource("Sky_5fqhf")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="RectangleShape2D" id="RectangleShape2D_647q1"]
size = Vector2(128, 128)

[node name="World" type="Node2D"]
texture_filter = 1

[node name="Holder" type="Node2D" parent="."]
texture_filter = 1
script = ExtResource("1_8sinw")

[node name="Game" type="Node2D" parent="Holder"]
texture_filter = 1

[node name="Path" type="Path2D" parent="Holder/Game"]
position = Vector2(-7, 11)
curve = SubResource("Curve2D_idbbu")
script = ExtResource("1_tkyns")
Update = true

[node name="Road" type="Line2D" parent="Holder/Game/Path"]
texture_repeat = 2
points = PackedVector2Array(239, 965, 240.865, 926.117, 242.956, 880.87, 244.222, 852.774, 245.607, 821.402, 247.093, 787.035, 248.659, 749.951, 250.285, 710.431, 251.951, 668.754, 253.638, 625.2, 255.324, 580.049, 256.992, 533.58, 258.619, 486.073, 260.187, 437.807, 261.676, 389.063, 263.065, 340.12, 264.335, 291.257, 265.466, 242.755, 266.437, 194.893, 267.229, 147.95, 267.822, 102.207, 268.195, 57.9428, 268.33, 15.4374, 268.206, -25.0296, 267.802, -63.1786, 267.1, -98.7298, 266.079, -131.404, 264.719, -160.92, 263, -187)
width = 200.0
texture = ExtResource("2_v5di0")
texture_mode = 1
metadata/_edit_lock_ = true

[node name="Road2" type="Line2D" parent="Holder/Game/Path"]
texture_repeat = 2
points = PackedVector2Array(239, 965, 240.865, 926.117, 242.956, 880.87, 244.222, 852.774, 245.607, 821.402, 247.093, 787.035, 248.659, 749.951, 250.285, 710.431, 251.951, 668.754, 253.638, 625.2, 255.324, 580.049, 256.992, 533.58, 258.619, 486.073, 260.187, 437.807, 261.676, 389.063, 263.065, 340.12, 264.335, 291.257, 265.466, 242.755, 266.437, 194.893, 267.229, 147.95, 267.822, 102.207, 268.195, 57.9428, 268.33, 15.4374, 268.206, -25.0296, 267.802, -63.1786, 267.1, -98.7298, 266.079, -131.404, 264.719, -160.92, 263, -187)
width = 200.0
texture = ExtResource("3_tq03e")
texture_mode = 1
metadata/_edit_lock_ = true

[node name="Coin" type="Area2D" parent="Holder/Game/Path" groups=["Coin"]]
z_index = 1
position = Vector2(7, -11)
script = ExtResource("10_jff2p")

[node name="Anim" type="AnimationPlayer" parent="Holder/Game/Path/Coin"]
root_node = NodePath("../Sprite")
libraries = {
"": SubResource("AnimationLibrary_o6m6g")
}
autoplay = "Loop"

[node name="Sprite" type="Sprite2D" parent="Holder/Game/Path/Coin"]
position = Vector2(0, -18.3258)
scale = Vector2(0.294055, 0.5)
texture = ExtResource("6_e4o34")
offset = Vector2(0, -4.94267)

[node name="Sprite2" type="Sprite2D" parent="Holder/Game/Path/Coin/Sprite"]
modulate = Color(0, 0, 0, 0.536)
show_behind_parent = true
position = Vector2(0, 36.6667)
rotation = 3.14159
scale = Vector2(1, -0.245)
texture = ExtResource("6_e4o34")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Holder/Game/Path/Coin"]
position = Vector2(0, -18.3258)
shape = SubResource("CircleShape2D_ofjcw")

[node name="Bush" type="Area2D" parent="Holder/Game/Path"]
z_index = 1
position = Vector2(111, 53)
script = ExtResource("10_jff2p")

[node name="Sprite" type="Sprite2D" parent="Holder/Game/Path/Bush"]
skew = 0.0121575
texture = ExtResource("11_epgcn")
offset = Vector2(0, -22.415)

[node name="Sprite2" type="Sprite2D" parent="Holder/Game/Path/Bush/Sprite"]
modulate = Color(0, 0, 0, 0.2)
show_behind_parent = true
position = Vector2(0.149048, -0.0196304)
rotation = 3.14159
scale = Vector2(2.645, -0.648)
texture = ExtResource("6_e4o34")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Holder/Game/Path/Bush"]
rotation = 1.57079
shape = SubResource("CapsuleShape2D_uj88y")

[node name="Anim" type="AnimationPlayer" parent="Holder/Game/Path/Bush"]
libraries = {
"": SubResource("AnimationLibrary_7kkvb")
}
autoplay = "Loop"

[node name="Cone" type="Area2D" parent="Holder/Game/Path"]
z_index = 1
position = Vector2(15, 133)
script = ExtResource("10_jff2p")

[node name="Sprite" type="Sprite2D" parent="Holder/Game/Path/Cone"]
skew = 0.0121575
texture = ExtResource("7_wpsmu")
offset = Vector2(0, -22.415)

[node name="Sprite2" type="Sprite2D" parent="Holder/Game/Path/Cone/Sprite"]
modulate = Color(0, 0, 0, 0.2)
show_behind_parent = true
position = Vector2(0.179033, -6.02008)
rotation = 3.14159
scale = Vector2(1.085, -0.446)
texture = ExtResource("6_e4o34")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Holder/Game/Path/Cone"]
rotation = 1.57079
shape = SubResource("CapsuleShape2D_uj88y")

[node name="Anim" type="AnimationPlayer" parent="Holder/Game/Path/Cone"]
libraries = {
"": SubResource("AnimationLibrary_7kkvb")
}
autoplay = "Loop"

[node name="Player" type="CharacterBody2D" parent="Holder/Game"]
position = Vector2(288, 336)
script = ExtResource("3_meqjs")

[node name="Car" type="Sprite2D" parent="Holder/Game/Player"]
position = Vector2(0, 8)
scale = Vector2(0.7, 0.7)
texture = ExtResource("4_qi03k")

[node name="Col" type="CollisionShape2D" parent="Holder/Game/Player"]
shape = SubResource("CapsuleShape2D_tln7t")

[node name="Grass" type="Sprite2D" parent="Holder/Game/Player"]
show_behind_parent = true
top_level = true
z_index = -100
texture_repeat = 2
position = Vector2(296, 248)
texture = ExtResource("5_id1i5")
region_enabled = true
region_rect = Rect2(0, 0, 2000, 2000)
metadata/_edit_lock_ = true

[node name="Cloud" type="Sprite2D" parent="Holder/Game/Player"]
modulate = Color(0, 0, 0, 0.286)
show_behind_parent = true
top_level = true
z_index = 1
texture_repeat = 2
position = Vector2(296, 248)
scale = Vector2(3, 3)
texture = ExtResource("6_yhhpp")
region_enabled = true
region_rect = Rect2(-999, 0, 720, 720)
metadata/_edit_lock_ = true

[node name="Cam" type="Camera2D" parent="Holder/Game/Player"]
unique_name_in_owner = true
offset = Vector2(0, -120)
zoom = Vector2(0.75, 0.75)
process_callback = 0
position_smoothing_enabled = true
position_smoothing_speed = 3.0
rotation_smoothing_enabled = true
rotation_smoothing_speed = 2.0

[node name="Detect" type="Area2D" parent="Holder/Game/Player"]

[node name="CollisionShape2D" type="CollisionShape2D" parent="Holder/Game/Player/Detect"]
shape = SubResource("CapsuleShape2D_iau05")

[node name="SFX" type="Node2D" parent="Holder/Game/Player"]

[node name="Coin" type="AudioStreamPlayer" parent="Holder/Game/Player/SFX"]
stream = ExtResource("15_pf4d7")
bus = &"SFX"

[node name="Engine" type="AudioStreamPlayer" parent="Holder/Game/Player/SFX"]
bus = &"SFX"

[node name="Drift" type="AudioStreamPlayer" parent="Holder/Game/Player/SFX"]
bus = &"SFX"

[node name="SmokeDrift" type="Node2D" parent="Holder/Game/Player"]
position = Vector2(0, 56)

[node name="Drift" type="Sprite2D" parent="Holder/Game/Player"]
visible = false
top_level = true
position = Vector2(0, 56)
scale = Vector2(0.8, 1)
texture = ExtResource("14_bm6gg")
offset = Vector2(0, -18)
region_enabled = true
region_rect = Rect2(189, 422, 168, 46)

[node name="Fade" type="AnimationPlayer" parent="Holder/Game/Player/Drift"]
libraries = {
"": SubResource("AnimationLibrary_xqs7r")
}
speed_scale = 0.5

[node name="CoinFx" type="Sprite2D" parent="Holder/Game/Player"]
visible = false
modulate = Color(1, 1, 1, 0)
top_level = true
rotation = -3.14159
scale = Vector2(0.3, 0.3)
texture = ExtResource("6_e4o34")

[node name="AnimationPlayer" type="AnimationPlayer" parent="Holder/Game/Player/CoinFx"]
libraries = {
"": SubResource("AnimationLibrary_f40we")
}

[node name="Boost" type="Timer" parent="Holder/Game/Player"]
wait_time = 0.075
autostart = true

[node name="Smoke" type="CPUParticles2D" parent="Holder/Game/Player"]
position = Vector2(16, 48)
amount = 4
texture = ExtResource("5_5jckg")
gravity = Vector2(0, 0)
angle_min = -311.4
angle_max = 291.9
scale_amount_curve = SubResource("Curve_jtax1")
color_ramp = SubResource("Gradient_ncpum")

[node name="SubViewport" type="SubViewport" parent="."]
unique_name_in_owner = true
canvas_item_default_texture_filter = 0
size = Vector2i(1280, 960)

[node name="Surface" type="MeshInstance3D" parent="."]
material_overlay = SubResource("StandardMaterial3D_i3iis")
mesh = SubResource("SphereMesh_ulcu4")

[node name="Camera3D" type="Camera3D" parent="Surface"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 6)

[node name="WorldEnvironment" type="WorldEnvironment" parent="Surface"]
environment = SubResource("Environment_0i5t4")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Surface"]
transform = Transform3D(-0.866023, -0.433016, 0.250001, 0, 0.499998, 0.866027, -0.500003, 0.749999, -0.43301, 0, 0, 0)
shadow_enabled = true

[node name="CanvasLayer" type="CanvasLayer" parent="."]
script = ExtResource("16_bm7o5")

[node name="Control" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="DownLeft" type="Control" parent="CanvasLayer/Control"]
layout_mode = 1
anchors_preset = 2
anchor_top = 1.0
anchor_bottom = 1.0
offset_left = 40.0
offset_top = -40.0
offset_right = 80.0
grow_vertical = 0

[node name="Left" type="TouchScreenButton" parent="CanvasLayer/Control/DownLeft"]
position = Vector2(8, -16)
scale = Vector2(0.75, 0.75)
shape = SubResource("RectangleShape2D_647q1")
action = "ui_left"

[node name="Right" type="TouchScreenButton" parent="CanvasLayer/Control/DownLeft"]
position = Vector2(120, -16)
scale = Vector2(0.75, 0.75)
shape = SubResource("RectangleShape2D_647q1")
action = "ui_right"

[node name="Wheel" type="Sprite2D" parent="CanvasLayer/Control/DownLeft"]
position = Vector2(64, -16)
scale = Vector2(0.75, 0.75)
texture = ExtResource("17_371yy")

[node name="Label" type="Label" parent="CanvasLayer/Control/DownLeft"]
layout_mode = 0
offset_left = -8.0
offset_top = -56.0
offset_right = 136.0
offset_bottom = -36.0
text = "Steer"
horizontal_alignment = 1

[connection signal="area_entered" from="Holder/Game/Player/Detect" to="Holder/Game/Player" method="_on_detect_area_entered"]
[connection signal="visibility_changed" from="Holder/Game/Player/Drift" to="Holder/Game/Player/Drift/Fade" method="play" binds= ["Fade"]]
[connection signal="visibility_changed" from="Holder/Game/Player/CoinFx" to="Holder/Game/Player/CoinFx/AnimationPlayer" method="play" binds= ["Pop"]]
[connection signal="timeout" from="Holder/Game/Player/Boost" to="Holder/Game/Player" method="_on_boost_timeout"]
